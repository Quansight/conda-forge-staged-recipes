{% set name = "kudu-cpp" %}
{% set version = "1.9.0" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://github.com/apache/kudu/archive/{{ version }}.tar.gz
  sha256: 0ff304009606a28101f10010fb0b02d5e8f7e7254892468ca8d1d3624ba44672
  patches:
    - patches/cmake_modules/FindGFlags.cmake.patch
    - patches/cmake_modules/FindGLog.cmake.patch
    - patches/cmake_modules/FindGMock.cmake.patch
    - patches/cmake_modules/FindGPerf.cmake.patch
    - patches/cmake_modules/FindLibEv.cmake.patch
    - patches/cmake_modules/FindLibUnwind.cmake.patch
    - patches/cmake_modules/FindLz4.cmake.patch
    - patches/cmake_modules/FindProtobuf.cmake.patch
    - patches/cmake_modules/FindSnappy.cmake.patch
    - patches/cmake_modules/FindThrift.cmake.patch

build:
  number: 0
  skip: True  # [win]
  # script: "{{ PYTHON }} -m pip install . --no-deps -vv"

requirements:
  build:
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}
    - autoconf
    - automake
    - bison
    - cmake >=3.4.3
    - curl
    - gcovr
    - gmock
    - flex
    - git
    - make
    - openjdk 8.*
    - patch
    - pkg-config
    - protobuf
    - rsync
    - unzip
  host:
    - boost-cpp
    - gflags
    - glog >=0.3.5  # Glog 0.3.5 which includes CMake support
    - gtest
    - libev
    - libtool
    - libunwind
    - llvmdev
    - lz4
    - openssl >=1.0.0
    - python
    - rapidjson
    - sentry-sdk
    - snappy
    - sparsehash
    - krb5
    - ntplib
    - sasl
    - thrift-cpp
    - zlib
  run:
    - boost-cpp
    - gflags
    - glog >=0.3.5
    - libev
    - libtool
    - libunwind
    - llvmdev
    - lz4
    - openssl >=1.0.0
    - python
    - rapidjson
    - sentry-sdk
    - snappy
    - sparsehash
    - krb5
    - ntplib
    - sasl
    - thrift-cpp
    - zlib

test:
  imports:
    - simplejson
    - simplejson.tests

about:
  home: https://kudu.apache.org
  license: Apache-2.0
  license_family: Apache
  license_file: LICENSE.txt
  summary: 'Apache Kudu completes Hadoop storage layer to enable fast analytics on fast data.'
  description: |
    Kudu provides a combination of fast inserts/updates and efficient columnar 
    scans to enable multiple real-time analytic workloads across a single storage 
    layer. As a new complement to HDFS and Apache HBase, Kudu gives architects 
    the flexibility to address a wider variety of use cases without exotic workarounds.
  doc_url: https://kudu.apache.org/docs/
  dev_url: https://github.com/apache/kudu

extra:
  recipe-maintainers:
    - xmnlab
